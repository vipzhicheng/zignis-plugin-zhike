<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## repl

Implement hook: repl.
Add Zhike resources into Zignis REPL mode.

### Examples

```javascript
// Fetch zhike consul config，alias: zhike.config
$ zignis repl
>>> await zhike.consul.get('db.user', 'oss')
```

```javascript
// Support all ioredis apis, alias: zhike.cache
$ zignis repl
>>> await zhike.redis.keys('*')
```

```javascript
// All database instances are loaded into zhike.db.instances
// Database instances are Sequelize model instances
// You can not do dangerous Sequelize operations in REPL mode
$ zignis repl
>>> await zhike.db.load('db.user', 'user')
>>> const { Account } = zhike.db.instances.user.models
>>> await Account.count()
27378
```

Returns **[object][1]** Zhike resources, for now include consul, redis, db.

## components

Implement hook: components.
Add Zhike resources into plugins which depend on this plugin, or Zignis scripts.

### Examples

```javascript
// Used in command defination
const { components } = require('zignis-plugin-zhike')
const co = require('co')
exports.handler = function(argv) {
  co(function*() {
    const { db } = yield components()
    // Here, Sequelize instance is returned directly, different from repl hook
    const userDb = yield db.load('db.user', 'user', db.associate('./models'))
    const { Account } = userDb.models
    const count = await Account.count()
  }
}
```

```javascript
// Zignis script db access demo
module.exports = function*(components) {
  const { config } = yield components()
  console.log(yield config.get('oss'))
  console.log('Start to draw your dream code!')
  process.exit(0)
}
```

```javascript
// Consul config watch demo
const { consul } = await components()
const config = await consul.getAndWatch('socialPrivate,oss', function(key, value) {
  config[key] = value
  console.log(`Consul key: ${key} changed to:`, value)
})
```

Returns **[object][1]** Zhike resources, for now include consul, redis, db.

## load

实例化数据库连接，数据库配置可以从 consul 取，也可以直接传给 load 方法

### Parameters

-   `consulKey` **([string][2] \| [array][3])** 
-   `instanceKey` **[string][2]**  (optional, default `''`)
-   `callback` **[function][4]** 

[1]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[2]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[3]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[4]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function
